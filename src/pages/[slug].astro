---
import Layout from '../layouts/Layout.astro';
import { projects, publicPath } from '../config/projects';
import SkillTag from '../components/SkillTag.astro';

export async function getStaticPaths() {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const isGoKart = project.slug === 'go-kart-v2';
const isRoboChess = project.slug === 'robochess';
const isOmniframe = project.slug === 'omniframe';
const isDaylight = project.slug === 'daylight';
const isVitrail = project.slug === 'vitrail';
const isMemoryPlayer = project.slug === 'memory-player';
const isHeyMac = project.slug === 'hey-mac';
const BASE_URL = import.meta.env.BASE_URL;

// Gallery images for Go-Kart
const goKartImages = [
  '20190707_134935.webp',
  '20190707_134943.webp',
  '20190707_134954.webp',
  '20190707_135023.webp',
  '20190707_135027.webp',
  '20190707_135041.webp',
];

// Gallery images for RoboChess
const roboChessImages = [
  'front.jpg',
  'rightup.jpg',
  'showcase.jpg',
  'switch.jpg',
  'presentation.jpg',
  'award.jpg',
];

// Process media for RoboChess
const roboChessProcess = [
  { file: 'early_render.jpg', caption: 'Early render of showing the gantry and rough hardware placement.', type: 'image', fullSize: true },
  { file: 'tape.jpg', caption: 'The dark squares were made by applying wood filler to laser-engraved grooves. The tape was for protecting other areas.', type: 'image', fullSize: false },
  { file: 'assembly.jpg', caption: 'Hardware getting assembled', type: 'image', fullSize: false },
  { file: 'Sensor_array.jpg', caption: 'The hall-effect sensor matrix was installed under the pieces to detect piece locations to enable more game-modes.', type: 'image', fullSize: false },
  { file: 'calibration.mp4', caption: 'Calibration test of the assembled gantry before placement to the enclosure. The board uses limit switches to zero its axis at every boot up similar to a 3D-printer.', type: 'video', fullSize: false },
];

// Gallery images for Daylight
const daylightImages = [
  'Render 4.webp',
  'Render 5.webp',
];
---

<Layout title={project.title}>
  <main class="container mx-auto px-8 py-12">
    <!-- Header -->
    <div class="max-w-6xl mx-auto mb-12">
      <h1 class="text-5xl font-bold mb-4" style="font-family: 'Faculty Glyphic', sans-serif;">
        {project.title}
      </h1>
      <p class="text-xl text-gray-400">
        {project.year}{project.inProgress ? ' (in progress)' : ''}
      </p>
    </div>

    <!-- Menu -->
    <div class="flex justify-center gap-4 mb-16">
      <button class="menu-btn active" data-section="overview">Overview</button>
      {!isGoKart && <button class="menu-btn" data-section="technology">Technology</button>}
      {!isGoKart && <button class="menu-btn" data-section="process">Process</button>}
      <button class="menu-btn" data-section="gallery">Gallery</button>
    </div>

    <div class="max-w-6xl mx-auto space-y-24">
      <!-- Overview Section -->
      <section id="overview" class="section-content scroll-mt-32">
        <div class="space-y-16">
          {isDaylight ? (
            <>
              {project.overview && project.overview[0] ? (
                <div class={`flex gap-12 items-center ${project.overview[0].imagePosition === 'right' ? 'flex-row-reverse' : ''}`}>
                  {project.overview[0].image && (
                    <div class="w-1/2">
                      <img src={project.overview[0].image} alt={project.title} class="rounded-2xl w-full" />
                    </div>
                  )}
                  <div class="w-1/2">
                    <p class="text-lg text-gray-300 leading-relaxed whitespace-pre-line">
                      {project.overview[0].description}
                    </p>
                  </div>
                </div>
              ) : (
                <div class="flex gap-12 items-center">
                  <div class="w-1/2">
                    <img src={project.image} alt={project.title} class="rounded-2xl w-full" />
                  </div>
                  <div class="w-1/2">
                    <p class="text-lg text-gray-300 leading-relaxed">
                      {project.description}
                    </p>
                  </div>
                </div>
              )}
              <div class="grid grid-cols-2 gap-6">
                <img
                  src={publicPath('Daylight/Render 1.webp')}
                  alt="Daylight render"
                  class="rounded-2xl w-full"
                />
                <img
                  src={publicPath('Daylight/Render 2.webp')}
                  alt="Daylight render"
                  class="rounded-2xl w-full"
                />
              </div>
            </>
          ) : project.overview ? (
            project.overview.map((section) => (
              section.image ? (
                <div class={`flex gap-12 items-center ${section.imagePosition === 'right' ? 'flex-row-reverse' : ''}`}>
                  <div class="w-1/2">
                    <img src={section.image} alt={project.title} class="rounded-2xl w-full" />
                  </div>
                  <div class="w-1/2">
                    <p class="text-lg text-gray-300 leading-relaxed whitespace-pre-line">
                      {section.description}
                    </p>
                  </div>
                </div>
              ) : (
                <div>
                  <p class="text-lg text-gray-300 leading-relaxed whitespace-pre-line">
                    {section.description}
                  </p>
                </div>
              )
            ))
          ) : isHeyMac && project.video ? (
            <div class="flex gap-12 items-center">
              <div class="w-1/2">
                <video
                  id="hey-mac-video"
                  src={project.video}
                  muted
                  playsinline
                  class="rounded-2xl w-full"
                ></video>
              </div>
              <div class="w-1/2">
                <p class="text-lg text-gray-300 leading-relaxed">
                  {project.description}
                </p>
              </div>
            </div>
          ) : (
            <div class="flex gap-12 items-center">
              <div class="w-1/2">
                <img src={project.image} alt={project.title} class="rounded-2xl w-full" />
              </div>
              <div class="w-1/2">
                <p class="text-lg text-gray-300 leading-relaxed">
                  {project.description}
                </p>
              </div>
            </div>
          )}
        </div>
      </section>

      <!-- Technology Section -->
      {!isGoKart && (
        <section id="technology" class="section-content scroll-mt-32">
          <h2 class="text-3xl font-bold mb-8" style="font-family: 'Faculty Glyphic', sans-serif;">
            Technology
          </h2>
          <div class="flex flex-wrap gap-3 mb-12">
            {project.skills.map((skill) => (
              <SkillTag name={skill.name} category={skill.category} />
            ))}
          </div>
          {isRoboChess ? (
            <>
              <p class="text-lg text-gray-300 leading-relaxed mb-8">
                The board uses an Arduino Mega 2560 to communicate with a mobile phone via Bluetooth to get the voice commands for players' moves. The pieces are moved by a magnet that moves on a 2D-Gantry featuring low-profile stepper motors, timing belts, and servo-attached magnet that moves vertically to engage with the pieces. Early iterations used an electromagnet but the permanent magnet system was found to be smoother and more reliable. To enable users to also use manual moves instead of playing with only voice, a hall-effect sensor matrix was added directly under the pieces.
              </p>
              <h3 class="text-xl font-bold mb-4" style="font-family: 'Faculty Glyphic', sans-serif;">
                Hardware System Diagram
              </h3>
              <div class="mt-8 flex justify-center">
                <img
                  src={publicPath('RoboChess/Robo_diagram.png')}
                  alt="RoboChess System Diagram"
                  class="rounded-2xl w-[70%]"
                />
              </div>
            </>
          ) : isOmniframe ? (
            <>
              <h3 class="text-xl font-bold mb-6" style="font-family: 'Faculty Glyphic', sans-serif;">
                Hardware
              </h3>
              <div class="grid grid-cols-2 gap-6">
                <div>
                  <img
                    src={publicPath('Omniframe/omni_diagram.png')}
                    alt="Omniframe system diagram"
                    class="rounded-2xl w-full"
                  />
                </div>
                <div>
                  <img
                    src={publicPath('Omniframe/v4_board.webp')}
                    alt="Omniframe v4 board"
                    class="rounded-2xl w-full"
                  />
                </div>
              </div>
              <div class="mt-8 grid grid-cols-2 gap-6">
                <div>
                  <img
                    src={publicPath('Omniframe/main_sch.jpg')}
                    alt="Omniframe main schematic"
                    class="rounded-2xl w-full"
                  />
                </div>
                <div>
                  <img
                    src={publicPath('Omniframe/final_board_layout.png')}
                    alt="Omniframe final board layout"
                    class="rounded-2xl w-full"
                  />
                </div>
              </div>
              <h3 class="text-xl font-bold mb-6 mt-12" style="font-family: 'Faculty Glyphic', sans-serif;">
                Materials
              </h3>
              <div class="grid grid-cols-3 gap-6 mb-8">
                <div>
                  <img
                    src={publicPath('Omniframe/frame.webp')}
                    alt="Omniframe frame"
                    class="rounded-2xl w-full"
                  />
                </div>
                <div>
                  <img
                    src={publicPath('Omniframe/backboard.webp')}
                    alt="Omniframe backboard"
                    class="rounded-2xl w-full"
                  />
                </div>
                <div>
                  <img
                    src={publicPath('Omniframe/diffuser.webp')}
                    alt="Omniframe diffuser"
                    class="rounded-2xl w-full"
                  />
                </div>
              </div>
              <p class="text-lg text-gray-300 leading-relaxed">
                The frame is CNC machined from acacia wood. The backboard for V3 was resin-printed, while V4's backboard was CNC machined from ABS to develop it closer toward injection molding. The diffuser is 60% translucent and coated with a diffusing spray to hide the solar cells while allowing sufficient light transmission to continuously charge the device.
              </p>
              <h3 class="text-xl font-bold mb-6 mt-12" style="font-family: 'Faculty Glyphic', sans-serif;">
                Specifications
              </h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-lg">
                <div class="space-y-6">
                  <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-200">Display</h4>
                    <ul class="space-y-1 text-gray-300">
                      <li><span class="text-gray-400">Size:</span> 13.3 inches (27 x 20 cm)</li>
                      <li><span class="text-gray-400">Resolution:</span> 1600 x 1200 pixels</li>
                      <li><span class="text-gray-400">Grayscale Depth:</span> 256 shades</li>
                    </ul>
                  </div>
                  <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-200">Frame</h4>
                    <ul class="space-y-1 text-gray-300">
                      <li><span class="text-gray-400">Measurements:</span> 17 x 14 inches (44 x 36 cm)</li>
                      <li><span class="text-gray-400">Material:</span> Acacia hardwood</li>
                      <li><span class="text-gray-400">Mounting:</span> Rotating wall mount</li>
                    </ul>
                  </div>
                </div>
                <div class="space-y-6">
                  <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-200">Energy</h4>
                    <ul class="space-y-1 text-gray-300">
                      <li><span class="text-gray-400">Battery Capacity:</span> 12,000 mAh</li>
                      <li><span class="text-gray-400">Battery Life:</span> Over 1 year</li>
                      <li><span class="text-gray-400">Charging Port:</span> USB-C</li>
                    </ul>
                  </div>
                  <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-200">Other Features</h4>
                    <ul class="space-y-1 text-gray-300">
                      <li><span class="text-gray-400">Connectivity:</span> Wi-Fi and Bluetooth LE</li>
                      <li><span class="text-gray-400">Internal Storage:</span> 4 GB</li>
                      <li><span class="text-gray-400">Buttons:</span> Sync and Reset</li>
                    </ul>
                  </div>
                </div>
              </div>
            </>
          ) : isDaylight ? (
            <>
              <h3 class="text-xl font-bold mb-6" style="font-family: 'Faculty Glyphic', sans-serif;">
                Schematics
              </h3>
              <p class="text-lg text-gray-300 leading-relaxed mb-8">
                The device receives DisplayPort input through a USB-C port on the headband behind the left ear. A diverging cable splits the connection to both a power supply unit, which supplies the various voltages required by the main logic board and displays, and the data connection to the main logic board. The main logic board features a display driver IC (LT7911D), an STM32-based microcontroller, and a 9-axis IMU that detects and adjusts the output image according to the user's head movements. A touchpad board with a touch IC is located on the right temple of the device for user input.
              </p>
              <div class="space-y-8">
                <div>
                  <h4 class="text-lg font-semibold mb-3 text-gray-200">Main Logic Board</h4>
                  <img
                    src={publicPath('Daylight/main_sch.jpg')}
                    alt="Main board schematic"
                    class="rounded-2xl w-full"
                  />
                </div>
                <div class="grid grid-cols-2 gap-6">
                  <div>
                    <h4 class="text-lg font-semibold mb-3 text-gray-200">Connector Board</h4>
                    <img
                      src={publicPath('Daylight/connboard_sch.jpg')}
                      alt="Connection board schematic"
                      class="rounded-2xl w-full"
                    />
                  </div>
                  <div>
                    <h4 class="text-lg font-semibold mb-3 text-gray-200">Power Supply Unit</h4>
                    <img
                      src={publicPath('Daylight/psu_sch.jpg')}
                      alt="PSU schematic"
                      class="rounded-2xl w-full"
                    />
                  </div>
                </div>
                <div class="flex justify-center">
                  <div class="w-3/4">
                    <h4 class="text-lg font-semibold mb-3 text-gray-200">Touchpad Board</h4>
                    <img
                      src={publicPath('Daylight/touch_sch.jpg')}
                      alt="Touch pad schematic"
                      class="rounded-2xl w-full"
                    />
                  </div>
                </div>
              </div>
              <h3 class="text-xl font-bold mb-6 mt-12" style="font-family: 'Faculty Glyphic', sans-serif;">
                PCB Layouts
              </h3>
              <div class="space-y-6">
                <div class="space-y-2">
                  <img
                    src={publicPath('Daylight/Screen Shot 2023-01-30 at 10.27.12 PM.webp')}
                    alt="PCB layout"
                    class="rounded-2xl w-full"
                  />
                  <p class="text-sm text-gray-400 text-center">
                    The main logic board
                  </p>
                </div>
                <div class="flex justify-center">
                  <div class="grid grid-cols-2 gap-6 w-3/4">
                    <div class="space-y-2">
                      <img
                        src={publicPath('Daylight/Screen Shot 2023-01-30 at 10.28.07 PM.webp')}
                        alt="PCB layout"
                        class="rounded-2xl w-full"
                      />
                      <p class="text-sm text-gray-400 text-center">
                        The power supply unit
                      </p>
                    </div>
                    <div class="space-y-2">
                      <img
                        src={publicPath('Daylight/Screen Shot 2023-01-30 at 10.42.24 PM.webp')}
                        alt="PCB layout"
                        class="rounded-2xl w-full"
                      />
                      <p class="text-sm text-gray-400 text-center">
                        The USB-C connector board
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </>
          ) : isVitrail ? (
            <div class="grid grid-cols-3 gap-6">
              <div class="space-y-2">
                <img
                  src={publicPath('Vitrail/kab230-removebg-preview.png')}
                  alt="Dayton Audio KAB-230v4"
                  class="rounded-2xl w-full vitrail-tech-image"
                />
                <p class="text-sm text-gray-400 text-center">
                  Dayton Audio KAB-230v4 2 x 30W Class D Audio Amplifier Board with aptX HD Bluetooth 5.0
                </p>
              </div>
              <div class="space-y-2">
                <img
                  src={publicPath('Vitrail/bms-removebg-preview.png')}
                  alt="Dayton Audio KAB-BE"
                  class="rounded-2xl w-full vitrail-tech-image"
                />
                <p class="text-sm text-gray-400 text-center">
                  Dayton Audio KAB-BE 18650 Battery Extension Board
                </p>
              </div>
              <div class="space-y-2">
                <img
                  src={publicPath('Vitrail/rs100-removebg-preview.png')}
                  alt="Dayton Audio RS100-4"
                  class="rounded-2xl w-full vitrail-tech-image"
                />
                <p class="text-sm text-gray-400 text-center">
                  Dayton Audio RS100-4 4" Reference Full-Range Driver 4 Ohm
                </p>
              </div>
            </div>
          ) : isMemoryPlayer ? (
            <div class="flex gap-12 items-center">
              <div class="w-1/2">
                <img
                  src={publicPath('Memory Player/parts.jpeg')}
                  alt="Memory Player parts"
                  class="rounded-2xl w-full"
                />
              </div>
              <div class="w-1/2">
                <p class="text-lg text-gray-300 leading-relaxed">
                  This is easily the smallest physical size product I've ever built. To save time and money, I deciced to use the Adafruit Feather ThinkInk board instead of making a custom PCB. The device also features a 2000 mAh LiPo battery for a years-long battery life, a USB-C port for charging and reprogramming, a pinhole reset button in the back and two buttons in the front for scrolling.
                </p>
              </div>
            </div>
          ) : (
            <p class="text-gray-400">Technical details and diagrams coming soon.</p>
          )}
        </section>
      )}

      <!-- Process Section -->
      {!isGoKart && (
        <section id="process" class="section-content scroll-mt-32">
          <h2 class="text-3xl font-bold mb-8" style="font-family: 'Faculty Glyphic', sans-serif;">
            Process
          </h2>
          {isRoboChess ? (
            <>
              <p class="text-lg text-gray-300 leading-relaxed mb-8">
                Unfortunately, this project was poorly documented. The design and fabrication of this project was completed in full between October and December of 2022.
              </p>
              <div class="grid grid-cols-2 gap-6">
                {roboChessProcess.map((item) => (
                  <div class={`space-y-2 ${item.fullSize ? '' : 'flex flex-col items-center'}`}>
                    {item.type === 'video' ? (
                      <video
                        src={publicPath(`RoboChess/${item.file}`)}
                        controls
                        class={`rounded-2xl ${item.fullSize ? 'w-full' : 'w-[70%]'}`}
                      ></video>
                    ) : (
                      <img
                        src={publicPath(`RoboChess/${item.file}`)}
                        alt={item.caption}
                        class={`rounded-2xl ${item.fullSize ? 'w-full' : 'w-[70%]'}`}
                      />
                    )}
                    <p class="text-sm text-gray-400 text-center">{item.caption}</p>
                  </div>
                ))}
              </div>
            </>
          ) : isDaylight ? (
            <>
              <div class="space-y-6 mb-8 flex flex-col items-center">
                <img
                  src={publicPath('Daylight/dev board.jpg')}
                  alt="Development board"
                  class="rounded-2xl w-1/2"
                />
                <p class="text-sm text-gray-400 text-center">
                  This was the development board for driving these displays.
                </p>
              </div>
              <p class="text-lg text-gray-300 leading-relaxed mb-8">
                To rapidly iterate on waveguide prototypes, I built a testing setup that allowed me to quickly swap between different waveguide designs. This modular approach enabled efficient evaluation of optical performance and helped identify the most promising designs for further development.
              </p>
              <div class="grid grid-cols-3 gap-6">
                <div class="h-64 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Daylight/waveguide_dev1.jpg')}
                    alt="Waveguide development setup"
                    class="w-full h-full object-cover"
                  />
                </div>
                <div class="h-64 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Daylight/waveguide_dev2.jpg')}
                    alt="Waveguide development setup"
                    class="w-full h-full object-cover"
                  />
                </div>
                <div class="h-64 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Daylight/waveguide_dev3.jpg')}
                    alt="Waveguide development setup"
                    class="w-full h-full object-cover"
                  />
                </div>
              </div>
              <p class="text-lg text-gray-300 leading-relaxed mt-8">
                The optics design proved to be more complex than I initially anticipated, requiring resources and expertise beyond what I could provide independently. I reached out to potential collaborators at the university and explored partnerships with private companies specializing in optical systems, but unfortunately, these efforts didn't materialize into a viable path forward for the project.
              </p>
            </>
          ) : isVitrail ? (
            <>
              <div class="grid grid-cols-2 gap-6 mb-6">
                <div class="space-y-2">
                  <img
                    src={publicPath('Vitrail/gluing.jpg')}
                    alt="Enclosure assembly gluing process"
                    class="rounded-2xl w-full vitrail-process-image"
                  />
                  <p class="text-sm text-gray-400 text-center">
                    Enclosure assembly gluing process
                  </p>
                </div>
                <div class="space-y-2">
                  <img
                    src={publicPath('Vitrail/before_oil.jpg')}
                    alt="All enclosure parts prepared for surface finishing"
                    class="rounded-2xl w-full vitrail-process-image"
                  />
                  <p class="text-sm text-gray-400 text-center">
                    All enclosure parts prepared for surface finishing with a high-quality furniture oil.
                  </p>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-6 mb-6">
                <img
                  src={publicPath('Vitrail/old_open.jpg')}
                  alt="Old open"
                  class="rounded-2xl w-full"
                />
                <img
                  src={publicPath('Vitrail/old_closed.jpg')}
                  alt="Old closed"
                  class="rounded-2xl w-full"
                />
              </div>
              <p class="text-lg text-gray-300 leading-relaxed mb-6">
                I used these Dayton Audio ND105-4 4" Aluminum Cone Midbass Neo Driver 4 Ohm drivers originally, but later upgraded to the RS100 drivers and also made a new front baffle that was 1 mm thinner to make the grid sit more flush with the design.
              </p>
              <div class="grid grid-cols-2 gap-6 items-start">
                <div class="space-y-2">
                  <img
                    src={publicPath('Vitrail/newbaffle.jpg')}
                    alt="New front baffle"
                    class="rounded-2xl w-full vitrail-baffle-image"
                  />
                  <p class="text-sm text-gray-400 text-center">
                    New front baffle CNC machined from MDF.
                  </p>
                </div>
                <div>
                  <video
                    src={publicPath('Vitrail/bafflecnc.mp4')}
                    controls
                    autoplay
                    loop
                    class="rounded-2xl w-full vitrail-baffle-video"
                  ></video>
                </div>
              </div>
            </>
          ) : isOmniframe ? (
            <>
              <h3 class="text-xl font-bold mb-4" style="font-family: 'Faculty Glyphic', sans-serif;">
                V1
              </h3>
              <p class="text-lg text-gray-300 leading-relaxed mb-8">
                The first version was done with an acrylic backplate and different boards soldered together on a resin printed holder and had individual solar cells soldered together on nickel strips.
              </p>
              <div class="grid grid-cols-3 gap-6 mb-16">
                <div class="h-96 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Omniframe/v1.webp')}
                    alt="Omniframe v1"
                    class="w-full h-full object-cover rounded-2xl"
                  />
                </div>
                <div class="h-96 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Omniframe/v1_inside.webp')}
                    alt="Omniframe v1 inside"
                    class="w-full h-full object-cover rounded-2xl"
                  />
                </div>
                <div class="h-96 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Omniframe/v1_hardware.webp')}
                    alt="Omniframe v1 hardware"
                    class="w-full h-full object-cover rounded-2xl"
                  />
                </div>
              </div>
              <h3 class="text-xl font-bold mb-4" style="font-family: 'Faculty Glyphic', sans-serif;">
                V2
              </h3>
              <div class="w-full">
                <div class="grid grid-cols-2 gap-6 mb-6">
                  <div class="h-96 overflow-hidden rounded-2xl">
                    <video
                      src={publicPath('Omniframe/v2.mp4')}
                      autoplay
                      loop
                      muted
                      playsinline
                      class="w-full h-full object-cover"
                    ></video>
                  </div>
                  <div class="flex items-center">
                    <p class="text-lg text-gray-300 leading-relaxed">
                      The form factor turned closer to the final product, and had a better diffuser made from special coated translucent acrylic. And second-generation custom PCB that skipped the display driver IC that the first generation had and instead used low-level driver firmware to drive the display directly with the ESP.
                    </p>
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-6">
                  <div class="h-96 overflow-hidden rounded-2xl">
                    <video
                      src={publicPath('Omniframe/cnc.mp4')}
                      autoplay
                      loop
                      muted
                      playsinline
                      class="w-full h-full object-cover"
                    ></video>
                  </div>
                  <div class="h-96 overflow-hidden rounded-2xl">
                    <img
                      src={publicPath('Omniframe/v2_hardware.webp')}
                      alt="Omniframe v2 hardware"
                      class="w-full h-full object-cover"
                    />
                  </div>
                </div>
              </div>
              <h3 class="text-xl font-bold mb-4 mt-16" style="font-family: 'Faculty Glyphic', sans-serif;">
                V3 & V4
              </h3>
              <div class="grid grid-cols-2 gap-6 mb-6">
                <div class="h-110 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Omniframe/v3_drawing.webp')}
                    alt="Omniframe v3 drawing"
                    class="w-full h-full object-cover"
                  />
                </div>
                <div class="flex items-center">
                  <p class="text-lg text-gray-300 leading-relaxed">
                    DFM and DFA were the major focuses of V3 and V4. The total number of components was significantly reduced and the backboard was designed for injection molding. The hardware assembly featured a unified solar cell, an improved main logic board with refined power architecture, production opimizations, and SD card holder, and a secondary board with button and USB-C port, connected via ribbon cable.
                  </p>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-6">
                <div class="h-106 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Omniframe/v4_backboard.webp')}
                    alt="Omniframe v4 backboard"
                    class="w-full h-full object-cover brightness-70"
                  />
                </div>
                <div class="h-106 overflow-hidden rounded-2xl">
                  <img
                    src={publicPath('Omniframe/v4_hardware_assembly.webp')}
                    alt="Omniframe v4 hardware assembly"
                    class="w-full h-full object-cover brightness-80"
                  />
                </div>
              </div>
            </>
          ) : isMemoryPlayer ? (
            <>
              <div class="grid grid-cols-2 gap-6 mb-6">
                <div class="space-y-4">
                  <img
                    src={publicPath('Memory Player/braces.png')}
                    alt="Braces"
                    class="rounded-2xl w-full"
                  />
                  <p class="text-sm text-gray-400 text-center">
                    I had a cheap USB-C breakout that didn't end up working due to wrongly wired CC-pins. For the new breakout board I had to make a new internal brace (the green part).
                  </p>
                </div>
                <div class="space-y-4">
                  <img
                    src={publicPath('Memory Player/new_brace.png')}
                    alt="New brace"
                    class="rounded-2xl w-full"
                  />
                  <p class="text-sm text-gray-400 text-center">
                    New breakout soldered and attached to new brace along with buttons.
                  </p>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-6 mb-6">
                <div class="space-y-4">
                  <video
                    src={publicPath('Memory Player/buttons.MOV')}
                    autoplay
                    loop
                    muted
                    playsinline
                    class="rounded-2xl"
                    style="height: 70vh; max-width: 80%; margin: 0 auto; display: block;"
                  ></video>
                  <p class="text-sm text-gray-400 text-center">
                    The front plate has two buttons.
                  </p>
                </div>
                <div class="space-y-4">
                  <video
                    src={publicPath('Memory Player/battery.MOV')}
                    autoplay
                    loop
                    muted
                    playsinline
                    class="rounded-2xl"
                    style="height: 70vh; max-width: 80%; margin: 0 auto; display: block;"
                  ></video>
                  <p class="text-sm text-gray-400 text-center">
                    Checking the board voltage after installing the battery.
                  </p>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-6 mb-6">
                <div class="space-y-4">
                  <video
                    src={publicPath('Memory Player/fit.MOV')}
                    autoplay
                    loop
                    muted
                    playsinline
                    class="rounded-2xl"
                    style="height: 70vh; max-width: 80%; margin: 0 auto; display: block;"
                  ></video>
                  <p class="text-sm text-gray-400 text-center">
                    The tolerances I had designed turned out to have been way too optimistic. The front plate stuck out from the enclosure slightly.
                  </p>
                </div>
                <div class="space-y-4">
                  <video
                    src={publicPath('Memory Player/silicone.mp4')}
                    autoplay
                    loop
                    muted
                    playsinline
                    class="rounded-2xl"
                    style="height: 70vh; max-width: 80%; margin: 0 auto; display: block;"
                  ></video>
                  <p class="text-sm text-gray-400 text-center">
                    To counter the poorly fitting front plate I put black silicone glue all around it. Once dry, I scratched it slightly with 400 grit sandpaper which made its color match with the front plate.
                  </p>
                </div>
              </div>
              <div class="mb-6">
                <div class="space-y-4">
                  <img
                    src={publicPath('Memory Player/oil.png')}
                    alt="Oil finish"
                    class="rounded-2xl"
                    style="width: 40vw; object-fit: cover; margin: 0 auto; display: block;"
                  />
                  <p class="text-sm text-gray-400 text-center">
                    The oak enclosure was finished with two coats of colorless furniture oil.
                  </p>
                </div>
              </div>
              <p class="text-lg text-gray-300 leading-relaxed">
                Routing the USB-C port to the outside of the enclosure turned out to take a huge amount of time because of the spatial constraints. If I were to build this again, I would implement everything necessary from Adafruit's design to a better form factor for the enclosure. This would eliminate the need for the secondary Type-C port and would allow to put the battery next to the board as opposed under it. This would save almost half of the thickness of the device. Maybe I'll do this for another anniversary years from now to also compare how far E-Ink technology has come.
              </p>
            </>
          ) : (
            <p class="text-gray-400">Assembly photos and development process coming soon.</p>
          )}
        </section>
      )}

      <!-- Gallery Section -->
      <section id="gallery" class="section-content scroll-mt-32">
        <h2 class="text-3xl font-bold mb-8" style="font-family: 'Faculty Glyphic', sans-serif;">
          Gallery
        </h2>
        {isGoKart ? (
          <div class="grid grid-cols-2 gap-6">
            {goKartImages.map((img) => (
              <img
                src={publicPath(`Go-Kart V2/${img}`)}
                alt={`Go-Kart ${img}`}
                class="rounded-2xl w-full"
              />
            ))}
          </div>
        ) : isRoboChess ? (
          <div class="grid grid-cols-2 gap-6">
            {roboChessImages.map((img) => (
              <img
                src={publicPath(`RoboChess/${img}`)}
                alt={`RoboChess ${img}`}
                class="rounded-2xl w-full"
              />
            ))}
          </div>
        ) : isDaylight ? (
          <div class="grid grid-cols-2 gap-6">
            {daylightImages.map((img) => (
              <img
                src={publicPath(`Daylight/${img}`)}
                alt={`Daylight ${img}`}
                class="rounded-2xl w-full"
              />
            ))}
          </div>
        ) : isMemoryPlayer ? (
          <div class="grid grid-cols-2 gap-6">
            <img
              src={publicPath('Memory Player/size_comparison.jpeg')}
              alt="Size comparison"
              class="rounded-2xl w-full"
              style="height: 50vh; object-fit: cover;"
            />
            <img
              src={publicPath('Memory Player/final_angle.jpeg')}
              alt="Final angle"
              class="rounded-2xl w-full"
              style="height: 50vh; object-fit: cover;"
            />
            <img
              src={publicPath('Memory Player/back.jpeg')}
              alt="Back"
              class="rounded-2xl w-full"
              style="height: 50vh; object-fit: cover;"
            />
            <img
              src={publicPath('Memory Player/final_otter.jpeg')}
              alt="Final otter"
              class="rounded-2xl w-full"
              style="height: 50vh; object-fit: cover;"
            />
          </div>
        ) : (
          <p class="text-gray-400">Gallery images coming soon.</p>
        )}
      </section>

      <!-- All Projects Button -->
      <div class="flex justify-center mt-16 mb-12">
        <a
          href={BASE_URL}
          class="menu-btn"
        >
          All Projects
        </a>
      </div>
    </div>
  </main>
</Layout>

<style>
  .menu-btn {
    padding: 0.75rem 2rem;
    border-radius: 9999px;
    font-weight: 500;
    background-color: rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
    border: 2px solid transparent;
    text-decoration: none;
    display: inline-block;
    color: inherit;
  }

  .menu-btn:hover {
    background-color: rgba(255, 255, 255, 0.15);
  }

  .menu-btn.active {
    background-color: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
  }

  .vitrail-tech-image {
    filter: brightness(0.8);
  }

  .vitrail-baffle-video {
    height: 400px;
    object-fit: cover;
  }

  .vitrail-baffle-image {
    height: 400px;
    object-fit: cover;
  }

  .vitrail-process-image {
    height: 400px;
    object-fit: cover;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const menuButtons = document.querySelectorAll('.menu-btn');

    menuButtons.forEach((button) => {
      button.addEventListener('click', () => {
        const sectionId = button.getAttribute('data-section');
        const section = document.getElementById(sectionId);

        // Update active button
        menuButtons.forEach((btn) => btn.classList.remove('active'));
        button.classList.add('active');

        // Scroll to section
        section?.scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    });

    // Hey Mac video handling
    const heyMacVideo = document.getElementById('hey-mac-video');
    if (heyMacVideo) {
      // Start playing after 1s delay
      setTimeout(() => {
        heyMacVideo.play().catch(() => {
          // Auto-play might be blocked, that's okay
        });
      }, 1000);
    }
  });
</script>
